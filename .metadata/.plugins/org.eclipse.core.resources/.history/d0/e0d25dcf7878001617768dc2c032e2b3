import java.util.HashMap;

/**
 * LeetCode
 * 399. Evaluate Division
 * @author lorreina
 *
 */
public class Evaluate_Division {
	public double[] calcEquation(String[][] equations, double[] values, String[][] query) {
        if (query == null || query.length == 0) {
            return null;
        }
        double[] res = new double[query.length];
        HashMap<String, HashMap<String, Double>> map = new HashMap<String, HashMap<String, Double>> ();
        
        
        if (values != null && values.length != 0) {
            for (int i = 0; i < values.length; i++) {
                if (map.containsKey(equations[i][0])) {
                    map.get(equations[i][0]).put(equations[i][1], values[i]);
                } else {
                    HashMap<String, Double> tmp = new HashMap<String, Double> ();
                    tmp.put(equations[i][1], values[i]);
                    map.put(equations[i][0], tmp);
                }
                
                double num = (double) 1 / values[i];
                if (map.containsKey(equations[i][1])) {
                    map.get(equations[i][1]).put(equations[i][0], num);
                } else {
                    HashMap<String, Double> tmp = new HashMap<String, Double> ();
                    tmp.put(equations[i][0], num);
                    map.put(equations[i][1], tmp);
                }
            }
        }
        
        for (int i = 0; i < query.length; i++) {
            if (!map.containsKey(query[i][0]) || !map.containsKey(query[i][1])) {
                res[i] = -1.0;
            } else if (query[i][0].equals(query[i][1])) {
                res[i] = 1.0;
            } else {
                res[i] = find(map, query[i][0], query[i][1])[1];
            }
        }
        
        return res;
    }
    
    private double[] find(HashMap<String, HashMap<String, Double>> map, String a, String b) {
        double res[] = new double[2];
        HashMap<String, Double> amap = map.get(a);
        if (amap.containsKey(b)) {
            res[0] = 1;
            res[1] = amap.get(b);
            return res;
        }
        
        for (String s : amap.keySet()) {
            double tmp[] = find(map, s, b);
            if (tmp[0] == 1) {
                res[0] = 1;
                res[1] = tmp[1] * amap.get(s);
                return res;
            }
        }
        
        return res;
    }
    
    public static void main(String[] args) {
    	Evaluate_Division tmp = new Evaluate_Division();
    	String[][] equations = {{"x1", "x2"}, {"x2", "x3"}, {"x3", "x4"}, {"x4", "x5"}};
    	double[] values = {}3, 4, 5, 6};
    	String[][] query
    }
}
